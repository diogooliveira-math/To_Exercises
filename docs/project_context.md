---
project_name: To_Exercises
user_name: Diogo
date: 2025-12-03T00:00:00Z
generated_from: docs/architecture.md
communication_language: English and Portugues
summary: "Project context and key architecture decisions for To_Exercises. Contains concise metadata, ADR links, and prioritized next steps to get the repository to an implementable MVP."
---

# Project Context — To_Exercises

This document captures the current project context, the core architectural decisions made in the Architecture Decision Document, and the recommended next steps to move from design to implementation.

Este documento regista o contexto do projecto, as decisões arquitectónicas principais tomadas no Documento de Decisão de Arquitectura, e os próximos passos recomendados para passar do desenho à implementação.

## Basic Metadata / Metadados Básicos

- Project: To_Exercises
- Owner: Diogo
- Generated: 2025-12-03 (from docs/architecture.md)
- Workflow type: architecture (completed)
- Key input artifacts:
  - docs/analysis/prd-To_Exercises-2025-12-03.md
  - docs/analysis/product-brief-To_Exercises-2025-12-03.md
  - docs/analysis/session-summary-2025-12-03.md
  - docs/analysis/brainstorming-session-2025-12-02.md

## High-level purpose / Propósito de alto nível

- Preserve and make retrievable canonical exercise content stored as local LaTeX files plus indexed metadata.
- Provide a minimal, maintainable backend API and a generator that produces PDFs from LaTeX templates.

## Key decisions (summary) / Decisões chave (resumo)

1. Canonical data: file system (LaTeX files) + metadata in DB. (DB stores metadata and canonical file paths; LaTeX remains on disk.)
2. Deduplication by checksum with checksum history table to handle moves/renames.
3. Importer pattern: dry-run (JSON report) and apply (transactional upsert by checksum).
4. Stack: Python, FastAPI, SQLModel, SQLite for local/dev. Design to be portable to Postgres.
5. Generator: CLI (Typer) that calls API, renders LaTeX, and invokes local TeX toolchain.
6. Tests: pytest with in-memory SQLite fixtures for deterministic tests.

## ADRs and important artifacts / ADRs e artefactos importantes

- ADR: docs/adr/0001-checksum-policy.md (checksum & upsert policy)
- Architecture Decision Document: docs/architecture.md
- PRD and related inputs: docs/analysis/*.md

## Immediate prioritized next steps / Próximos passos priorizados

1. Fix packaging/layout so repository is importable (src/ layout) and add pyproject.toml. — Rationale: fixes import resolution in tests and CI.
2. Implement exercise_checksum_history table and add uniqueness/indexes for checksum + algorithm.
3. Add importer dry-run implementation (JSON report) and CLI (Typer). Keep apply mode explicit and transactional.
4. Scaffold FastAPI endpoints and add CRUD + query tests.
5. Create generator CLI that calls API and renders minimal LaTeX → PDF.
6. Add pytest in CI with an optional LaTeX build step gated by RUN_LATEX.

## Implementation constraints & notes / Restrições e notas

- Keep the system simple for a single-author workflow; prefer boring, well-understood tools.
- Tests should default to in-memory SQLite with PRAGMA foreign_keys = ON.
- Store JSON (tags/metadata) as TEXT in SQLite and serialize/deserialize at application layer for cross-DB compatibility.
- Generator depends on local TeX toolchain; CI should gate that step.

## Suggested next action (what I can do next) / Ação sugerida (o que posso fazer a seguir)

- I can scaffold the minimal project files now (src/to_exercises layout, pyproject.toml, basic models, database skeleton, tests/conftest.py, and a starter importer CLI). Tell me if you want me to proceed with scaffolding and file creation.

Posso criar os ficheiros base do projecto (layout src/, pyproject.toml, models básicos, database, fixture de testes e CLI de importador). Diga se quer que eu continue e eu crio os ficheiros.

---

Generated by Winston — Architect (bmm/agents/architect.md activation)
